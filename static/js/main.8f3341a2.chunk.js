(this.webpackJsonptournroute=this.webpackJsonptournroute||[]).push([[0],{105:function(e,t,a){e.exports=a(116)},110:function(e,t,a){},111:function(e,t,a){},112:function(e,t,a){},113:function(e,t,a){},116:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),r=a(87),s=a.n(r),o=(a(110),a(111),a(112),a(113),a(54)),i=a(55),l=a(77),m=a(75),u=a(61),d=a(123),p=a(89),y=a(88),h=a(74),f=a(8),v=a(121),b=a(125),g=a(124),E=a(122),N=a(76),w=a(83),C=a(126),j=function(e){Object(l.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e))._map=null,n.url_osrm_nearest="//router.project-osrm.org/nearest/v1/foot/",n.url_osrm_route="//router.project-osrm.org/route/v1/foot/",n.icon_url="https://openlayers.org/en/v4.6.5/examples/data/icon.png",n.state={height:300,center:[10.6,49.6]},n.getBounds=n.getBounds.bind(Object(u.a)(n)),n.updateDimensions=n.updateDimensions.bind(Object(u.a)(n)),n}return Object(i.a)(a,[{key:"updateDimensions",value:function(){var e=this;this.setState({height:this.getBounds().height},(function(){try{e._map.setSize([e.getBounds().width,e.getBounds().height])}catch(t){}}))}},{key:"getBounds",value:function(){var e=300,t=400;try{e=3*(t=this._mapEl.clientWidth)/4}catch(a){}return{width:t,height:e}}},{key:"setCoors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._map.getView().setCenter(Object(f.d)(e)),t&&this._map.getView().setZoom(t)}},{key:"setPoints",value:function(e){var t=this;this._map.addLayer(new v.a({id:"points",source:new g.a({features:e.reverse().map((function(e){var a=new y.a({geometry:new h.a(Object(f.d)(e)),name:"New Marker"}),n=new w.b({image:new C.a({anchor:[.5,46],anchorXUnits:"fraction",anchorYUnits:"pixels",src:t.icon_url})});return a.setStyle(n),a}))})}))}},{key:"setRoute",value:function(e){var t=this,a=e.map((function(e){return Object(f.l)(e).join()})).join(";");console.log("[setRoute]",a),fetch(this.url_osrm_route+a).then((function(e){return e.json()})).then((function(e){"Ok"===e.code?console.log(e):console.warn("[E][OLMap] Error on ".concat(t.url_osrm_route+a," request."))}))}},{key:"removeLayer",value:function(e){var t=this;this._map.getLayers().forEach((function(a){try{a.get("id")===e&&t._map.removeLayer(a)}catch(n){}}))}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.updateDimensions),this.updateDimensions(),this._map=new d.a({target:"map",layers:[new b.a({id:"map",source:new E.a({url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",projection:"EPSG:3857"})})],controls:Object(N.a)({rotate:!1}),view:new p.a({projection:"EPSG:3857",center:Object(f.d)(this.state.center),zoom:4})})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"render",value:function(){var e=this,t={width:"100%",height:this.state.height,backgroundColor:"#cccccc"};return c.a.createElement("div",null,c.a.createElement("div",{id:"map",style:t,ref:function(t){e._mapEl=t}}))}}]),a}(c.a.Component),k=a(44),x=a(53),O=a.n(x),_=a(81),S="4ldhsh3zxfur",D="muZKwjJvwP5jz8Raxs0Adwb2pQ2PYBZ3zrFVIwMxgok",P=function(){function e(){Object(o.a)(this,e)}return Object(i.a)(e,null,[{key:"getData",value:function(){var e=Object(_.a)(O.a.mark((function e(){var t,a,n,c,r,s,o,i,l,m=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=m.length>0&&void 0!==m[0]?m[0]:"country",c="{ cityCollection { items { name, country { name, sys { id } }, galleryCollection { items { title, url } }, coordinates { lat, lon }, description { json }, sys { id } } } }",r="{ placeCollection(limit: 1000) { items { name, schedule { json }, description { json }, sys { id }, city { name, sys { id }, country { name, sys { id } } }, coordinates { lat, lon } } } }",s="{ countryCollection { items { name, galleryCollection { items { title, url } }, sys { id } } } }",o="{ routeCollection { items { name, description { json }, placesCollection { items { name, schedule { json }, description { json }, sys { id }, coordinates { lat, lon } } }, sys { id }, city { name, coordinates { lat, lon }, sys { id }, country { name, sys { id } } } } } }",e.t0=t,e.next="country"===e.t0?8:"city"===e.t0?11:"place"===e.t0?14:"route"===e.t0?17:20;break;case 8:return a=s,n="countryCollection",e.abrupt("break",20);case 11:return a=c,n="cityCollection",e.abrupt("break",20);case 14:return a=r,n="placeCollection",e.abrupt("break",20);case 17:return a=o,n="routeCollection",e.abrupt("break",20);case 20:if(0!==a.length){e.next=22;break}return e.abrupt("return",[]);case 22:return e.next=24,window.fetch("https://graphql.contentful.com/content/v1/spaces/".concat(S,"/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(D)},body:JSON.stringify({query:a})});case 24:return i=e.sent,e.next=27,i.json();case 27:return l=e.sent,e.abrupt("return",l.data[n].items);case 29:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getCollection",value:function(){var e=Object(_.a)(O.a.mark((function e(t,a){var n,c,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=11;break}return n="{ ".concat(t,'Collection(where: { country: { sys: { id: "').concat(a,'" } } } ) { items { name, country { name, sys { id } }, galleryCollection { items { title, url } }, coordinates { lat, lon }, description { json }, sys { id } } } }'),e.next=4,window.fetch("https://graphql.contentful.com/content/v1/spaces/".concat(S,"/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(D)},body:JSON.stringify({query:n})});case 4:return c=e.sent,e.next=7,c.json();case 7:return r=e.sent,e.abrupt("return",r.data["".concat(t,"Collection")]);case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getEntry",value:function(){var e=Object(_.a)(O.a.mark((function e(t,a){var n,c,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=11;break}return n="{ ".concat(t,'(id: "').concat(a,'") { name } }'),e.next=4,window.fetch("https://graphql.contentful.com/content/v1/spaces/".concat(S,"/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(D)},body:JSON.stringify({query:n})});case 4:return c=e.sent,e.next=7,c.json();case 7:return r=e.sent,e.abrupt("return",r.data[t]);case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}]),e}();function B(e){var t=e.select,a=c.a.useState([]),n=Object(k.a)(a,2),r=n[0],s=n[1];return c.a.useEffect((function(){P.getData("country").then((function(e){s(e)}))}),[]),c.a.createElement("div",{className:"row mt-3"},r.map((function(e,a){return c.a.createElement("div",{className:"col-12 col-md-6 col-lg-4 mt-3",key:e.sys.id,onClick:function(){try{P.getCollection("city",e.sys.id).then((function(a){t(e,a.items,e.sys.id)}))}catch(a){console.error("[E] Countries: unable to select country",a)}}},c.a.createElement("div",{className:"card bg-primary text-white ux-cursor-pointer"},c.a.createElement("div",{className:"position-relative"},e.galleryCollection?c.a.createElement("img",{src:e.galleryCollection.items[0].url,className:"card-img-top ux-card-img",alt:e.galleryCollection.items[0].title}):c.a.createElement("div",{style:{height:"150px"}}),c.a.createElement("div",{className:"card-body ux-card-body py-2 px-3 "},c.a.createElement("h4",{className:"m-0 font-weight-bolder"},e.name),e.linkedFrom&&c.a.createElement("h6",{className:"m-0 font-weight-bolder"},e.linkedFrom.cityCollection.items.map((function(e,t){return c.a.createElement("small",{className:"mr-2",key:"country-city-".concat(e.sys.id)},e.name)}))))),c.a.createElement("div",{className:"card-footer py-2 px-3 bg-primary d-flex align-items-center justify-content-between"},c.a.createElement("span",{className:"small stretched-link"},"View Cities"),c.a.createElement("div",{className:"small"},c.a.createElement("i",{className:"fa fa-arrow-circle-right"})))))})))}function R(e){var t=e.select,a=e.list,n=void 0===a?[]:a,r=c.a.useState(n),s=Object(k.a)(r,2),o=s[0],i=s[1];return c.a.useEffect((function(){0===n.length&&P.getData("city").then((function(e){i(e)}))}),[n]),c.a.createElement("div",{className:"row mt-3"},o.map((function(e,a){return c.a.createElement("div",{className:"col-12 col-md-6 col-lg-4 mt-3",key:e.sys.id,onClick:function(){try{t(e,e.sys.id)}catch(a){console.error("[E] Cities: unable to select city",a)}}},c.a.createElement("div",{className:"card bg-success text-white ux-cursor-pointer"},c.a.createElement("div",{className:"position-relative"},e.galleryCollection?c.a.createElement("img",{src:e.galleryCollection.items[0].url,className:"card-img-top ux-card-img",alt:e.galleryCollection.items[0].title}):c.a.createElement("div",{style:{height:"150px"}}),c.a.createElement("div",{className:"card-body ux-card-body py-2 px-3 "},e.country&&c.a.createElement("h6",{className:"m-0 font-weight-bolder"},c.a.createElement("small",null,e.country.name)),c.a.createElement("h4",{className:"m-0 font-weight-bolder"},e.name))),c.a.createElement("div",{className:"card-footer py-2 px-3 bg-success d-flex align-items-center justify-content-between"},c.a.createElement("span",{className:"small stretched-link"},"View Places"),c.a.createElement("div",{className:"small"},c.a.createElement("i",{className:"fa fa-arrow-circle-right"})))))})))}var T=a(52);function z(e){var t=e.select,a=e.list,n=void 0===a?[]:a,r=e.city,s=e.country,o=c.a.useState(n),i=Object(k.a)(o,2),l=i[0],m=i[1];return c.a.useEffect((function(){0===n.length&&P.getData("place").then((function(e){if(r.length>0||s.length>0){var t=e.filter((function(e){return r.length>0?e.city.sys.id===r:s.length>0&&e.city.country.sys.id===s}));m(t)}else m(e)}))}),[]),c.a.createElement("div",{className:"row mt-3"},l.map((function(e,a){return c.a.createElement("div",{className:"col-12 mt-3",key:"place-".concat(a),onClick:function(){try{P.getEntry("place",e.sys.id).then((function(e){console.log(e)}))}catch(a){console.error("[E] Places: unable to load place data",a)}try{t(e,e.sys.id)}catch(a){console.error("[E] Places: unable to select place",a)}}},c.a.createElement("div",{className:"card ux-place-card ux-cursor-pointer"},c.a.createElement("div",{className:"card-header"},c.a.createElement("div",{className:"d-flex align-items-end justify-content-between"},c.a.createElement("h5",{className:"m-0 font-weight-bolder"},e.name),c.a.createElement("h6",{className:"m-0 font-weight-bolder"},e.city.name,", ",e.city.country.name))),e.schedule&&c.a.createElement("div",{className:"card-body pt-3 pb-2 place-schedule"},Object(T.documentToReactComponents)(e.schedule.json)),c.a.createElement("div",{className:"card-body place-description"},Object(T.documentToReactComponents)(e.description.json))))})))}function I(e){var t=e.select,a=e.selectPlace,n=e.list,r=void 0===n?[]:n,s=e.city,o=e.country,i=c.a.useState(r),l=Object(k.a)(i,2),m=l[0],u=l[1];return c.a.useEffect((function(){0===r.length&&P.getData("route").then((function(e){if(s.length>0||o.length>0){var t=e.filter((function(e){return s.length>0?e.city.sys.id===s:o.length>0&&e.city.country.sys.id===o}));u(t)}else u(e)}))}),[]),c.a.createElement("div",{className:"row mt-3"},m.map((function(e){return c.a.createElement("div",{className:"col-12 mt-3",key:e.sys.id},c.a.createElement("div",{className:"card ux-cursor-pointer",onClick:function(){try{var a=e.placesCollection.items.map((function(e){return[e.coordinates.lon,e.coordinates.lat]}));t(e,a,e.sys.id)}catch(n){console.error("[E] Routes: unable to select route",n)}}},c.a.createElement("div",{className:"card-header bg-primary text-white"},c.a.createElement("div",{className:"d-flex align-items-end justify-content-between"},c.a.createElement("h5",{className:"m-0 font-weight-bolder"},e.name),c.a.createElement("h6",{className:"m-0 font-weight-bolder"},e.city.name,", ",e.city.country.name))),c.a.createElement("div",{className:"card-body"},e.description&&c.a.createElement("div",{className:"route-description"},Object(T.documentToReactComponents)(e.description.json)),c.a.createElement("div",{className:"row"},e.placesCollection.items.map((function(e,t){return c.a.createElement("div",{className:"ux-route-item col-12 py-2",key:e.sys.id,onClick:function(t){t.stopPropagation();try{a(e,e.sys.id)}catch(t){console.error("[E] Routes: unable to select route place",t)}}},c.a.createElement("div",{className:"d-flex align-items-center"},c.a.createElement("div",{className:"mr-3"},c.a.createElement("i",{className:"fa fa-circle text-primary"})),c.a.createElement("div",{className:"card ux-place-card ux-cursor-pointer"},c.a.createElement("div",{className:"card-header"},c.a.createElement("h5",{className:"m-0 font-weight-bolder"},e.name)),e.schedule&&c.a.createElement("div",{className:"card-body pt-3 pb-2 place-schedule"},Object(T.documentToReactComponents)(e.schedule.json)),c.a.createElement("div",{className:"card-body place-description small"},Object(T.documentToReactComponents)(e.description.json)))))}))))))})))}var L=function(e){Object(l.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e))._map=null,n.state={tab:"countries",country:"Countries",countryID:"",city:"Cities",cityID:"",listCities:[],mapCenter:[10.6,49.6]},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return c.a.createElement(c.a.Fragment,null,c.a.createElement("nav",{className:"sb-topnav navbar navbar-expand navbar-dark bg-dark py-1"},c.a.createElement("div",{className:"container"},c.a.createElement("h6",{className:"navbar-brand font-weight-bolder mb-0"},"Tour & Route"))),c.a.createElement("div",{className:"ux-gradient"}),c.a.createElement("div",{className:"container px-md-0 mb-5"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 col-md-7 pt-4"},c.a.createElement("ul",{className:"nav nav-tabs"},c.a.createElement("li",{className:"nav-item mr-1",onClick:function(){e.setState({tab:"countries"})}},c.a.createElement("span",{className:"nav-link ".concat("countries"===this.state.tab?"active":"")},this.state.country)),c.a.createElement("li",{className:"nav-item mr-1",onClick:function(){e.setState({tab:"cities"})}},c.a.createElement("span",{className:"nav-link ".concat("cities"===this.state.tab?"active":"")},this.state.city)),c.a.createElement("li",{className:"nav-item mr-1",onClick:function(){e.setState({tab:"places"})}},c.a.createElement("span",{className:"nav-link ".concat("places"===this.state.tab?"active":"")},"Places")),c.a.createElement("li",{className:"nav-item mr-1",onClick:function(){e.setState({tab:"routes"})}},c.a.createElement("span",{className:"nav-link ".concat("routes"===this.state.tab?"active":"")},"Routes"))),"countries"===this.state.tab&&c.a.createElement(B,{select:function(t,a,n){e.setState({country:t.name,countryID:n,city:"Cities",cityID:"",listCities:a,tab:"cities"})}}),"cities"===this.state.tab&&c.a.createElement(R,{list:this.state.listCities,select:function(t,a){e.setState({tab:"places",city:t.name,cityID:a,mapCenter:[t.coordinates.lon,t.coordinates.lat]},(function(){e._map.setCoors(e.state.mapCenter,9)}))}}),"places"===this.state.tab&&c.a.createElement(z,{city:this.state.cityID,country:this.state.countryID,select:function(t,a){e._map.removeLayer("points"),e._map.setPoints([[t.coordinates.lon,t.coordinates.lat]]),e._map.setCoors([t.coordinates.lon,t.coordinates.lat],15)}}),"routes"===this.state.tab&&c.a.createElement(I,{city:this.state.cityID,country:this.state.countryID,select:function(t,a,n){e._map.removeLayer("points"),e._map.setPoints(a),e._map.setCoors([t.city.coordinates.lon,t.city.coordinates.lat],12)},selectPlace:function(t,a){e._map.removeLayer("points"),e._map.setPoints([[t.coordinates.lon,t.coordinates.lat]]),e._map.setCoors([t.coordinates.lon,t.coordinates.lat],15)}})),c.a.createElement("div",{className:"col-12 col-md-5"},c.a.createElement("div",{className:"sticky-top pt-4"},c.a.createElement("div",{className:"card shadow"},c.a.createElement("div",{className:"card-header"},c.a.createElement("h6",{className:"m-0 font-weight-bold"},"Map view")),c.a.createElement("div",{className:"card-body p-0"},c.a.createElement(j,{ref:function(t){e._map=t},center:this.state.mapCenter}))))))))}}]),a}(c.a.Component);var q=function(){return c.a.createElement(L,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[105,1,2]]]);
//# sourceMappingURL=main.8f3341a2.chunk.js.map